<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Wikipedia Searchin</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class = "header-wrap">
        <h1 id="title">search wikipedia</h1>

        <div>
            <a class="white-text" href="https://en.wikipedia.org/wiki/Special:Random" target="_blank"><h4>Random Wikipedia Button</h4></a>
        </div>
        
        <div class = "form">
            <input name="queryWiki" id="queryWiki" type="text">
            <button type="button" class="icon searchIcon"><img src="https://miro.medium.com/proxy/1*ZimH1QT0zKfzzgocMfpYOA.png" alt="Magnify" width="20px"></button>
        </div>
        
    </div>
    <div id="search-results-container"></div>
    

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        const outerDiv = document.getElementById("search-results-container");
       

        const button1 = document.querySelector('.searchIcon')

        const randButton = document.querySelector('.random-button')



        button1.addEventListener('click', getData)

        

        function getData(){
            let input = document.getElementById("queryWiki")
            input = input.value
            console.log(input)
            searchFunction(input)
        }
       
        function append(parent, el) {
            return parent.appendChild(el);
        }

        function createNode(element) {
            return document.createElement(element);
        }

        const searchFunction = async (query)=>{
            try{
                let headWrap = document.getElementsByClassName("header-wrap")
                headWrap.position = "absolute";
                headWrap.top = "0px"
                // get country is the response object which you can access the data using .data
                let response = await fetch(`https://en.wikipedia.org/w/api.php?action=query&list=search&prop=info&inprop=url&utf8=&format=json&origin=*&srlimit=20&srsearch=${query}`)
                let data = await response.json()
                console.log(data)

                let resultArr = data.query.search;
                resultArr.map(entry => {

                    let wikiEntryDiv = createNode('div');
                    wikiEntryDiv.id = 'wikiEntryDiv';

                    let wikiEntryAtag = createNode('a');
                    wikiEntryAtag.href = `https://en.wikipedia.org/wiki/${entry.title}`;

                    let h3Name = createNode('h3');
                    h3Name.innerHTML = entry.title;

                    let pSnippet = createNode('p');
                    pSnippet.innerHTML = `${entry.snippet}`;

                    append(wikiEntryDiv, wikiEntryAtag);
                    append(wikiEntryAtag, h3Name);
                    append(wikiEntryDiv, pSnippet)
                    
                    
                    append(outerDiv, wikiEntryDiv);

                })                    
            }
            catch(error) {
                console.log(error);
            };
        }
    </script>
</body>
</html>